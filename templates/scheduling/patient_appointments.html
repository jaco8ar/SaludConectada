{% extends "base.html" %}

{% block content %}
  <h2>Mis citas</h2>

  <p>
    <a href="{% url 'scheduling:new_appointment_step1' %}">Nueva cita</a>
  </p>

  {% if appointments %}
    <table border="1" cellpadding="4">
      <tr>
        <th>MÃ©dico</th>
        <th>Fecha y hora</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
      {% for appt in appointments %}
        <tr>
          <td>{{ appt.doctor }}</td>
          <td>{{ appt.scheduled_datetime }}</td>
          <td>{{ appt.get_status_display }}</td>
          <td>
            {% if appt.status != "CANCELED" %}
              <a href="{% url 'scheduling:cancel_appointment' appt.pk %}">Cancelar</a> |
              <a href="{% url 'clinical:video_call' appt.pk %}">Videollamada</a>
            {% else %}
              -
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>No tienes citas registradas.</p>
  {% endif %}
{% endblock %}
